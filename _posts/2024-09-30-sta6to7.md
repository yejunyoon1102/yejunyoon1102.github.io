---
layout : post
title : "데이터 분석 : 통계 101 데이터 분석 6장 ~ 7장"
date : 2024-09-30
categories : [Data Analysis, Statistics]
---
# 6장 ~ 7장

### 6.1 다양한 가설검정

![1.png](/assets/img/posts/STATISTIC/STATISTIC6to7/1.png)

각 상태에 따라 몇 개 데이터가 있는지를 나타내는 표 : **분할표**

![2.png](/assets/img/posts/STATISTIC/STATISTIC6to7/2.png)

데이터 유형이 양적 변수인지 질적 변수인지에 따라 해석 방법이 달라짐!!

표본의 수(집단의 수)도 분석 방법 선택에서 중요한 요소임

- 양적 변수의 성질

데이터에 양적 변수가 있는 경우, 어떤 분포를 취하는지가 검정 방법을 선택할 때 중요

→ 모집단이 수학적으로 다룰 수 있는 특정 분포를 따른다는 가정을 둔 가설검정을 **모수검정** 이라 함

→ 모집단 분포가 특정 분포라고 가정할 수 없을 때 **비모수검정** 이용

### 6.2 대푯값 비교

- **일표본 t 검정**

1개 집단의 평균값을 비교!

![3.png](/assets/img/posts/STATISTIC/STATISTIC6to7/3.png)

- **이표본 t 검정**

2개 집단의 평균값을 비교!

![4.png](/assets/img/posts/STATISTIC/STATISTIC6to7/4.png)

일반적인 t 검정에서는 등분산성을 가정하지만,

분산이 일치하지 않는 경우에는 웰치의 t 검정 이용

- **정규성 조사**
    - Q-Q 플롯 : 시각적 판단
    - 샤피로-윌크 검정 : 가설검정으로 조사
    - 콜모고로프-스미노르프 검정 : 이론적인 분포와 비교
- **등분산성 조사**
    - 바틀렛 검정
    - 레빈 검정

분산이 같다는 가설을 조사

이때 다음 전제를 이용하여 가설 검정 시행!

→ 귀무가설 : ‘2개 모집단의 분산은 같다’

→ 대립가설 : ‘2개 모집단의 분산은 같지 않다’

앞서 모집단 분포가 특정 분포라고 가정할 수 없을 때(정규성이 없는 경우) **비모수검정**으로 분류되는 방법을 사용한다고 했음

→ 윌콕슨 순위합 검정 : 평균값 대신 각 데이터 값의 순위에 기반하여 검정

→ 맨-휘트니 U 검정

비교할 2개 집단의 분포 모양 자체 같아야 함!!

![5.png](/assets/img/posts/STATISTIC/STATISTIC6to7/5.png)

→ 플리그너-폴리셀로 검정

→ 브루너-문첼 검정

2개 모집단 분포 형태가 같지 않을 때도 사용 가능!!

- **분산분석**

3개 이상의 집단의 평균값을 비교하는 방법!!

![6.png](/assets/img/posts/STATISTIC/STATISTIC6to7/6.png)

![7.png](/assets/img/posts/STATISTIC/STATISTIC6to7/7.png)

집단 내 변동 : 원래 존재하는 무작위 오차의 크기

집단 간 변동 : 차이가 있다면 큰 데이터 퍼짐, 차이가 없다면 작은 데이터 퍼짐

**F값 = (평균적인 집단 간 변동) / (평균적인 집단 내 변동)** 으로 계산

→ 귀무가설이 올바르다는 가정 하에 F분포를 따름

이 분포에서 관찰한 F값 이상으로 극단적인 값이 나올 확률이 p값!

- **다중비교 검정**

분산분석으로는 어느 쌍에 차이가 있는지까지는 알 수 없음!

집단의 수가 늘어날수록 이표본 t검정을 반복해 실행할 시 제 1종오류가 일어나기 쉬워짐

이 다중성 문제를 회피하고자 다중비교 검정을 이용!

→ 본페로니 교정

전체에서 유의수준 α를 설정했을 때의 검정 반복 횟수를 k라 하고, 매 검정에서는 α를 검정 횟수로 나는 값 α/k를 기준으로 가설검정을 하는 방법!

즉 p < α/k 라면 대립가설 채택(차이가 있다)

→ 튜키 검정 : 우수한 검정력

→ 던넷 검정 : 대조군의 비교에만 관심

→ 윌리엄스 검정 : 집단 간에 순위를 매길 수 있는 경우

![8.png](/assets/img/posts/STATISTIC/STATISTIC6to7/8.png)

- **3집단 이상의 비모수검정**

분산분석은 모수검정으로 분류되므로 각 집단의 데이터에는 정규성이 있어야 함

정규성이 없는 집단이 1개 이상이라면

→ 크러스컬-월리스 검정

→ 스틸-드와스 검정(튜키 검정에 상응)

→ 스틸 검정(던넷 검정에 상응)

### 6.3 비율 비교

범주형 변수에서도 모집단의 파라미터인 확률 P를 추가하거나, 가설을 세워서 검정 가능

- **이항검정**

하나의 범주가 확률 P, 또 하나의 범주가 확률 1-P로 나타나는지 조사

![9.png](/assets/img/posts/STATISTIC/STATISTIC6to7/9.png)

- **카이제곱검정 : 적합도검정**

이항검정은 범주가 2개일 때만! 더 일반적인 이산확률 분포에 이항검정의 방식을 적용하고 싶을 때!

먼저 귀무가설의 확률분포에서 얻을 수 있는 기대도수를 계산함

(기대도수 : 전체 개수에 각 확률을 곱한 값 → 가장 나타나기 쉬운 실현값)

x² : 카이제곱값

귀무가설이 올다면 이는 x²분포(카이제곱분포)라는 확률분포를 따름

- **카이제곱검정 : 독립성검정**

범주형 변수에서도 2개 변수의 관계를 조사해야 할 때가 있음!

한쪽 변수의 범주가 바뀌었을 때 다른 쪽 변수의 범주 비율이 달라지지 않을 때, 2개 변수는 독립적!!

→ 카이제곱검정의 독립성 검정!!

![10.png](/assets/img/posts/STATISTIC/STATISTIC6to7/10.png)

### 7.1 양적 변수 사이의 관계를 밝히다

양적 변수 사이의 관계를 가설검정으로 밝힐 수 있음

또 다른 방법인 상관과 회귀도 있음!!

- **상관**

산점도를 이용하여 두 양적변수의 관계를 시각화하면 어떤 관계가 있는지 대략적 파악 가능

2개 변수 사이의 관계성을 상관 이라고 함!!

주의) 상관이 있다고 해서 원인과 결과를 뜻하는 인과관계가 있는지까지는 알 수 없음

![11.png](/assets/img/posts/STATISTIC/STATISTIC6to7/11.png)

- **회귀**

y = f(x)라는 함수를 통해 변수 사이의 관계를 공식화 하는 것!

x를 설명변수(독립변수) / y를 반응변수(종속변수)

### 7.2 상관관계

2개의 양적 변수간 관계의 강도를 정량화 하는 방법

→ **피어슨 상관계수**

2개 양적 변수 사이의 선형관계가 얼마나 직선 관계에 가까운가를 평가

![12.png](/assets/img/posts/STATISTIC/STATISTIC6to7/12.png)

![13.png](/assets/img/posts/STATISTIC/STATISTIC6to7/13.png)

부호가 양일 때 : 양의 상관

부호가 음일 때 : 음의 상관

![14.png](/assets/img/posts/STATISTIC/STATISTIC6to7/14.png)

주의) 피어슨 상관계수는 ‘선형’ 관계성 정도를 정량화 한 것!!(곡선은 안돼..!)

주의) r은 선형 관계성의 ‘강도’를 정량화하기에, 직선의 기울기 크기는 관계가 없음!!

같은 r값이라도 분포가 상이하므로, 먼저 산점도를 그려 확인하는 것이 중요!!

- **정규성 검사**

피어슨 상관계수는 정규분포를 가정하므로

실전에서는 x축 데이터와 y축 데이터 각각에 대해 정규성을 확인한 후, 한쪽에 조금이라도 정규성이 없다면 비모수 상관계수를 이용하는 것이 적절!!

- **비모수 상관계수**

→ 스피어만 순위상관계수 p

→ 켄달 순위상관계수 τ

- **상관관계 사용 시 주의**

→ 2개 변수가 처음부터 종속이면 설령 무상관이래도 상관이 나타나게 되어버림

x축과 y축의 값이 개별 변수일 것, 나눗셈 등으로 변환하지 않았을 것을 사전에 확인

### 7.3 선형회귀

f(x)의 형태를 결정하는 파라미터 a, b를 회귀계수 라고 함!

![15.png](/assets/img/posts/STATISTIC/STATISTIC6to7/15.png)

![16.png](/assets/img/posts/STATISTIC/STATISTIC6to7/16.png)

- **최소제곱법**

데이터와 회귀식의 차이가 가능한 한 작게 만들어야 함!

→ 데이터와 모형 차이의 제곱을 모두 더한 값 E를 최소화 하는 방법

![17.png](/assets/img/posts/STATISTIC/STATISTIC6to7/17.png)

최소제곱법을 얻은 추정량은 비편향추정량 중에서도 가장 정밀도가 높은 비편향추정량이 됨!

→ 최량선형비편향추정량

- **신뢰구간 & 예측구간**

모집단의 회귀계수를 추정 : 신뢰구간

추정된 회귀모형을 기반으로 데이터가 분포하는 구간 : 예측구간

신뢰구간은 모형의 파라미터, 즉 모집단의 범위

예측구간은 얻을 수 있는 데이터의 범위

![18.png](/assets/img/posts/STATISTIC/STATISTIC6to7/18.png)

- **결정계수**

회귀식이 잘 들어맞는지 평가하는 지표로 결정계수 R² 이용(R-squared)

![19.png](/assets/img/posts/STATISTIC/STATISTIC6to7/19.png)

분모는 종속변수 전체의 분산

분자는 잔차를 제곱한 것의 총합(E)

설명변수 개수 k에 따라 조정한 조정 결정계수 R²(Adjusted R-squared)

![20.png](/assets/img/posts/STATISTIC/STATISTIC6to7/20.png)

- **오차의 등분산성과 정규성**

정규성 확인 : 샤피로-윌크 검정

등분산성 확인 : 브루쉬-페이건 검정

![21.png](/assets/img/posts/STATISTIC/STATISTIC6to7/21.png)